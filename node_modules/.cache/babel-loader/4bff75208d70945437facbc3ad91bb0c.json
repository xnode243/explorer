{"ast":null,"code":"import _typeof from \"/root/explorer/node_modules/@babel/runtime/helpers/esm/typeof.js\";\nimport \"core-js/modules/es.array.find-index.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.entries.js\";\nimport \"core-js/modules/es.number.to-fixed.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { BRow, BCol, BAlert, BCard } from 'bootstrap-vue';\nimport { formatNumber, formatTokenAmount, isToken, percent, timeIn, toDay, toDuration, tokenFormatter } from '@/libs/utils';\nimport ParametersModuleComponent from './components/parameters/ParametersModuleComponent.vue';\nimport ObjectFieldComponent from './components/ObjectFieldComponent.vue';\nexport default {\n  components: {\n    BRow: BRow,\n    BCol: BCol,\n    BAlert: BAlert,\n    BCard: BCard,\n    ParametersModuleComponent: ParametersModuleComponent,\n    ObjectFieldComponent: ObjectFieldComponent\n  },\n  data: function data() {\n    return {\n      syncing: false,\n      latestTime: '',\n      marketData: null,\n      chain: {\n        title: '',\n        class: 'border-primary',\n        items: [{\n          subtitle: 'height',\n          icon: 'BoxIcon',\n          color: 'light-success'\n        }, {\n          subtitle: 'bonded_and_supply',\n          icon: 'DollarSignIcon',\n          color: 'light-danger'\n        }, {\n          subtitle: 'bonded_ratio',\n          icon: 'PercentIcon',\n          color: 'light-warning'\n        }, {\n          subtitle: 'inflation',\n          icon: 'TrendingUpIcon',\n          color: 'light-primary'\n        }]\n      },\n      staking: {\n        title: 'Staking Parameters',\n        items: []\n      },\n      distribution: {\n        title: 'Distribution Parameters',\n        items: []\n      },\n      slashing: {\n        title: 'Slashing Parameters',\n        items: null\n      },\n      mint: {\n        title: 'Mint Parameters',\n        items: null\n      },\n      gov: {\n        title: 'Governance Parameters',\n        items: []\n      },\n      appVersion: null,\n      nodeVersion: null\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    this.$http.getLatestBlock().then(function (res) {\n      var height = _this.chain.items.findIndex(function (x) {\n        return x.subtitle === 'height';\n      });\n\n      _this.$set(_this.chain, 'title', \"Chain ID: \".concat(res.block.header.chain_id));\n\n      _this.$set(_this.chain.items[height], 'title', res.block.header.height);\n\n      if (timeIn(res.block.header.time, 3, 'm')) {\n        _this.syncing = true;\n      } else {\n        _this.syncing = false;\n      }\n\n      _this.latestTime = toDay(res.block.header.time, 'long');\n    });\n    this.$http.getStakingParameters().then(function (res) {\n      _this.staking = _this.normalize(res, 'Staking Parameters');\n      Promise.all([_this.$http.getStakingPool(), _this.$http.getBankTotal(res.bond_denom)]).then(function (pool) {\n        var bondedAndSupply = _this.chain.items.findIndex(function (x) {\n          return x.subtitle === 'bonded_and_supply';\n        });\n\n        _this.$set(_this.chain.items[bondedAndSupply], 'title', \"\".concat(formatNumber(formatTokenAmount(pool[0].bondedToken, 2, res.bond_denom, false), true, 0), \"/\").concat(formatNumber(formatTokenAmount(pool[1].amount, 2, res.bond_denom, false), true, 0)));\n\n        var bondedRatio = _this.chain.items.findIndex(function (x) {\n          return x.subtitle === 'bonded_ratio';\n        });\n\n        _this.$set(_this.chain.items[bondedRatio], 'title', \"\".concat(percent(pool[0].bondedToken / pool[1].amount), \"%\"));\n      });\n    });\n    this.$http.getSlashingParameters().then(function (res) {\n      _this.slashing = _this.normalize(res, 'Slashing Parameters');\n    });\n    var conf = this.$http.getSelectedConfig();\n\n    if (conf.excludes && conf.excludes.indexOf('mint') > -1) {\n      this.mint = null;\n    } else {\n      this.$http.getMintingInflation().then(function (res) {\n        var chainIndex = _this.chain.items.findIndex(function (x) {\n          return x.subtitle === 'inflation';\n        });\n\n        _this.$set(_this.chain.items[chainIndex], 'title', \"\".concat(percent(res), \"%\"));\n      });\n      this.$http.getMintParameters().then(function (res) {\n        _this.mint = _this.normalize(res, 'Minting Parameters');\n      });\n    }\n\n    this.$http.getDistributionParameters().then(function (res) {\n      _this.distribution = _this.normalize(res, 'Distribution Parameters');\n    });\n\n    if (conf.excludes && conf.excludes.indexOf('governance') > -1) {\n      this.gov.items = [];\n    } else {\n      Promise.all([this.$http.getGovernanceParameterDeposit(), this.$http.getGovernanceParameterTallying(), this.$http.getGovernanceParameterVoting()]).then(function (data) {\n        var items = [];\n        data.forEach(function (item) {\n          var values = _this.normalize(item, '').items;\n\n          items = items.concat(values);\n        });\n        _this.gov.items = items;\n\n        _this.$set(_this.gov, 'items', items);\n      });\n    }\n\n    this.$http.getNodeInfo().then(function (res) {\n      _this.appVersion = res.application_version;\n      _this.nodeVersion = res.default_node_info;\n    });\n  },\n  methods: {\n    normalize: function normalize(data, title) {\n      if (!data) return null;\n      var items = this.makeItems(data);\n      return {\n        title: title,\n        items: items\n      };\n    },\n    makeItems: function makeItems(data) {\n      var _this2 = this;\n\n      return Object.keys(data).map(function (k) {\n        if (isToken(data[k])) {\n          return {\n            title: tokenFormatter(data[k]),\n            subtitle: k\n          };\n        }\n\n        if (typeof data[k] === 'boolean') {\n          return {\n            title: data[k],\n            subtitle: k\n          };\n        }\n\n        return {\n          title: _this2.convert(data[k]),\n          subtitle: k\n        };\n      });\n    },\n    convert: function convert(v) {\n      var _this3 = this;\n\n      if (_typeof(v) === 'object') {\n        var v2 = {};\n        Object.entries(v).forEach(function (e) {\n          var k = e[0];\n          var x = e[1];\n          v2[k] = _this3.convert(x);\n        });\n        return v2;\n      }\n\n      var d = parseFloat(v);\n      if (d === 0) return '0';\n\n      if (d < 1.01) {\n        return \"\".concat(percent(d), \"%\");\n      }\n\n      if (d > 1000000000) {\n        return \"\".concat(toDuration(d / 1000000));\n      }\n\n      if (d > 0) {\n        return d.toFixed();\n      }\n\n      return v;\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}