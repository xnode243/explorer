{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { BCard, BTable, BCardTitle, BButton } from 'bootstrap-vue';\nimport { fromBase64 } from '@cosmjs/encoding';\nimport { decodeTxRaw } from '@cosmjs/proto-signing';\nimport Tx from '@/libs/data/tx';\nimport { abbrMessage, tokenFormatter } from '@/libs/utils';\nimport ObjectFieldComponent from './components/ObjectFieldComponent.vue';\nimport ArrayFieldComponent from './components/ArrayFieldComponent.vue';\nexport default {\n  components: {\n    BButton,\n    BCard,\n    BTable,\n    BCardTitle,\n    ObjectFieldComponent,\n    ArrayFieldComponent\n  },\n\n  beforeRouteUpdate(to, from, next) {\n    const {\n      height\n    } = to.params;\n\n    if (height > 0 && height !== from.params.height) {\n      this.initData(height);\n      next();\n    }\n  },\n\n  data() {\n    return {\n      block: {\n        block: {\n          header: {},\n          data: {},\n          evidence: {}\n        }\n      },\n      txs: null,\n      height: 0,\n      fields: [{\n        key: 'hash'\n      }, {\n        key: 'fee',\n        formatter: v => tokenFormatter(v)\n      }, {\n        key: 'messages',\n        formatter: v => abbrMessage(v)\n      }, {\n        key: 'memo'\n      }]\n    };\n  },\n\n  created() {\n    const {\n      height\n    } = this.$route.params;\n    this.initData(height);\n  },\n\n  methods: {\n    initData(height) {\n      this.height = height;\n      this.$http.getBlockByHeight(height).then(res => {\n        this.block = res;\n        const {\n          txs\n        } = res.block.data;\n        if (txs === null) return;\n        const array = [];\n\n        for (let i = 0; i < txs.length; i += 1) {\n          let tx = new Tx();\n\n          try {\n            const origin = decodeTxRaw(fromBase64(txs[i]));\n            tx = Tx.create(origin);\n          } catch (e) {// catch errors\n          }\n\n          tx.setHash(txs[i]);\n          array.push(tx);\n        }\n\n        if (array.length > 0) this.txs = array;\n      });\n    },\n\n    goblock(height) {\n      this.$router.push({\n        name: 'block',\n        params: {\n          height\n        }\n      });\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}