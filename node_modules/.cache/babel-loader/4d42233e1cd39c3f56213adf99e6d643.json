{"ast":null,"code":"import compareVersions from 'compare-versions';\nimport ProposalTally from './proposal-tally';\nexport default class Proposal {\n  constructor() {\n    this.element = null;\n    this.id = 0;\n    this.status = 1;\n    this.type = '-';\n    this.title = '-';\n    this.description = '-';\n    this.tally = new ProposalTally();\n    this.submit_time = '0000-00-00';\n    this.voting_end_time = '0000-00-00';\n    this.voting_start_time = '0000-00-00';\n    this.total_deposit = '-';\n    this.contents = null;\n    this.metadata = {};\n  }\n\n  init(element, total) {\n    this.element = element;\n    this.id = element.proposal_id || element.id;\n    this.status = element.status;\n    this.tally = new ProposalTally().init(element.final_tally_result, total);\n    this.submit_time = element.submit_time;\n    this.voting_end_time = element.voting_end_time;\n    this.voting_start_time = element.voting_start_time; // eslint-disable-next-line prefer-destructuring\n\n    this.total_deposit = element.total_deposit[0];\n    if (element.content) this.contents = element.content.value || element.content;\n\n    if (this.contents) {\n      this.title = this.contents.title;\n      this.description = this.contents.description;\n      this.type = element.content.type;\n\n      if (element.content['@type']) {\n        this.type = element.content['@type'];\n      }\n    }\n\n    this.metadata = element.metadata;\n    return this;\n  }\n\n  hello() {\n    return this.title;\n  }\n\n  updateTally(newTally) {\n    this.tally = newTally;\n  }\n\n  versionFixed(ver) {\n    if (compareVersions(ver, '0.46') >= 0) {\n      if (this.element.messages) [this.contents] = this.element.messages;\n      if (this.contents) this.type = this.contents['@type'];\n\n      if (this.contents['@type'] === '/cosmos.gov.v1.MsgExecLegacyContent') {\n        this.title = this.contents.content.title;\n        this.description = this.contents.content.description;\n      }\n\n      if (this.element.metadata) {\n        this.title = this.element.metadata.title || this.element.metadata;\n        this.description = this.element.metadata.description || this.element.metadata;\n      }\n    } else if (compareVersions(ver, '0.30') >= 0) {\n      switch (this.element.proposal_status) {\n        case 'Passed':\n          this.status = 3;\n          break;\n\n        case 'VotingPeriod':\n          this.status = 2;\n          break;\n\n        case 'Rejected':\n          this.status = 4;\n          break;\n\n        default: // this.status = 1\n\n      }\n    }\n\n    if (String(this.status).indexOf('PASSED') > -1) {\n      this.status = 3;\n    } else if (String(this.status).indexOf('VOTING') > -1) {\n      this.status = 2;\n    } else if (String(this.status).indexOf('REJECTED') > -1) {\n      this.status = 4;\n    } else if (String(this.status).indexOf('DEPOSIT') > -1) {\n      this.status = 1;\n    }\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}