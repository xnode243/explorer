"use strict";
exports.__esModule = true;
exports.monitorCharacteristic = void 0;
var rxjs_1 = require("rxjs");
var logs_1 = require("@ledgerhq/logs");
var monitorCharacteristic = function (characteristic) {
    return rxjs_1.Observable.create(function (o) {
        (0, logs_1.log)("ble-verbose", "start monitor " + characteristic.uuid);
        function onCharacteristicValueChanged(event) {
            var characteristic = event.target;
            if (characteristic.value) {
                o.next(Buffer.from(characteristic.value.buffer));
            }
        }
        characteristic.startNotifications().then(function () {
            characteristic.addEventListener("characteristicvaluechanged", onCharacteristicValueChanged);
        });
        return function () {
            (0, logs_1.log)("ble-verbose", "end monitor " + characteristic.uuid);
            characteristic.stopNotifications();
        };
    });
};
exports.monitorCharacteristic = monitorCharacteristic;
//# sourceMappingURL=monitorCharacteristic.js.map