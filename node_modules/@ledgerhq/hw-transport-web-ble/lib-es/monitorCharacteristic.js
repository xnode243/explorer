import { Observable } from "rxjs";
import { log } from "@ledgerhq/logs";
export var monitorCharacteristic = function (characteristic) {
    return Observable.create(function (o) {
        log("ble-verbose", "start monitor " + characteristic.uuid);
        function onCharacteristicValueChanged(event) {
            var characteristic = event.target;
            if (characteristic.value) {
                o.next(Buffer.from(characteristic.value.buffer));
            }
        }
        characteristic.startNotifications().then(function () {
            characteristic.addEventListener("characteristicvaluechanged", onCharacteristicValueChanged);
        });
        return function () {
            log("ble-verbose", "end monitor " + characteristic.uuid);
            characteristic.stopNotifications();
        };
    });
};
//# sourceMappingURL=monitorCharacteristic.js.map