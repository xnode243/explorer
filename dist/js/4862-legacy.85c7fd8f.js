"use strict";(self["webpackChunkping_wallet"]=self["webpackChunkping_wallet"]||[]).push([[4862],{54862:function(t,e,n){n.r(e),n.d(e,{default:function(){return H}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-tabs",{attrs:{"content-class":"mt-1"}},[n("b-tab",{attrs:{title:"Active Proposals",pill:""}},[n("b-row",{staticClass:"match-height"},t._l(t.list,(function(e,a){return n("b-col",{key:e.id+"-"+a,attrs:{lg:"6",md:"12"}},[n("b-card",[n("b-card-title",{on:{click:function(e){return t.description("model-"+a)}}},[n("b-avatar",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{src:e.chain.logo,variant:"light-primary",size:"22",title:e.chain.chain_name}}),t._v(" #"+t._s(e.id)+". "),n("router-link",{attrs:{to:"/"+e.chain.chain_name+"/gov/"+e.id+"?from=/wallet/votes"}},[t._v(" "+t._s(e.title)+" ")])],1),n("div",{staticClass:"overflow-auto",class:t.descId==="model-"+a?"d-block":"d-none"},[n("object-field-component",{attrs:{tablefield:e.contents,small:!1}})],1),n("div",{staticClass:"gov-wrapper d-flex flex-wrap"},[n("div",{staticClass:"gov"},[n("p",{staticClass:"card-text mb-25"},[t._v(" Type ")]),n("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t.formatType(e.contents["@type"]))+" ")])]),n("div",{staticClass:"gov"},[n("p",{staticClass:"card-text mb-25"},[t._v(" Start Date ")]),n("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t.formatDate(e.voting_start_time))+" ")])]),n("div",{staticClass:"gov"},[n("p",{staticClass:"card-text mb-25"},[t._v(" End Date ")]),n("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t.formatDate(e.voting_end_time))+" ")])]),n("div",{staticClass:"gov"},[n("p",{staticClass:"card-text mb-25"},[t._v(" Deposit ")]),n("h6",{staticClass:"mb-0"},[t._v(" "+t._s(t.formatToken(e.total_deposit)||"-")+" ")])])]),n("b-progress",{staticClass:"my-2",attrs:{max:100,height:"2rem","show-progress":""}},[n("b-progress-bar",{attrs:{id:"vote-yes"+e.id,variant:"success",value:t.percent(e.tally.yes),"show-progress":"",label:t.percent(e.tally.yes).toFixed()+"%"}}),n("b-progress-bar",{attrs:{id:"vote-no"+e.id,variant:"danger",value:t.percent(e.tally.no),label:t.percent(e.tally.no).toFixed()+"%","show-progress":""}}),n("b-progress-bar",{staticClass:"bg-danger bg-darken-4",attrs:{id:"vote-veto"+e.id,value:t.percent(e.tally.veto),label:t.percent(e.tally.veto).toFixed()+"%","show-progress":""}}),n("b-progress-bar",{attrs:{id:"vote-abstain"+e.id,variant:"secondary",value:t.percent(e.tally.abstain),label:t.percent(e.tally.abstain).toFixed()+"%","show-progress":""}})],1),n("b-tooltip",{attrs:{target:"vote-yes"+e.id}},[t._v(" "+t._s(t.percent(e.tally.yes))+"% voted Yes ")]),n("b-tooltip",{attrs:{target:"vote-no"+e.id}},[t._v(" "+t._s(t.percent(e.tally.no))+"% voted No ")]),n("b-tooltip",{attrs:{target:"vote-veto"+e.id}},[t._v(" "+t._s(t.percent(e.tally.veto))+"% voted No With Veto ")]),n("b-tooltip",{attrs:{target:"vote-abstain"+e.id}},[t._v(" "+t._s(t.percent(e.tally.abstain))+"% voted Abstain ")]),n("b-card-footer",{staticClass:"pb-0"},t._l(e.votes,(function(e,a){return n("span",{key:a},[n("b-badge",{attrs:{variant:t.color(e.vote.option)}},[t._v(t._s(e.keyname)+" : "+t._s(t.formatOption(e.vote.option)))])],1)})),0)],1)],1)})),1)],1),n("b-tab",{attrs:{title:"Upgrade Events",lazy:""}},[n("wallet-upgrade-events")],1)],1)},r=[],o=(n(2707),n(21249),n(92222),n(57327),n(41539),n(69826),n(26833),n(34553),n(68309),n(74916),n(15306),n(54747),n(47941),n(21703),n(47389)),s=n(51015),i=n(58887),l=n(26253),c=n(50725),u=n(8775),d=n(37674),f=n(49379),p=n(26034),v=n(45752),h=n(22981),m=n(18365),b=n(5870),_=n(20266),g=n(54333),y=n(27484),T=n.n(y),x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-row",{staticClass:"match-height"},t._l(t.list,(function(e,a){return n("b-col",{key:e.id+"-"+a,attrs:{lg:"6",md:"12"}},[n("b-card",{attrs:{"bg-variant":e.variant}},[n("b-card-title",{staticClass:"mb-1"},[n("b-avatar",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{src:e.chain.logo,title:e.chain.chain_name,variant:"light-primary",size:"22"}}),t._v(" #"+t._s(e.id)+". "),n("router-link",{attrs:{to:"/"+e.chain.chain_name+"/gov/"+e.id+"?from=/wallet/votes"}},[t._v(" "+t._s(e.title)+" "+t._s(e.status)+" ")])],1),n("flip-countdown",{attrs:{deadline:e.countdown,"countdown-size":"28px","label-size":"12px"}})],1)],1)})),1)],1)},k=[],w=(n(26699),n(65167)),C=n.n(w),O={name:"WalletUpgradeEvents",components:{BAvatar:o.SH,BRow:l.T,BCol:c.l,BCard:u._,BCardTitle:f._,FlipCountdown:C()},directives:{"b-tooltip":b.o},props:{content:{type:String,default:function(){return""}}},data:function(){return{proposals:[],latest:{}}},computed:{list:function(){var t=this;return this.proposals.filter((function(t){return[2,3].includes(t.status)})).map((function(e){var n=e;return n.countdown=t.estmatetime(e.chain.chain_name,e.contents.plan),n.variant=T()().isAfter(T()(n.countdown))?"dark":"",n})).sort((function(t,e){return T()(e.voting_end_time).unix()-T()(t.voting_end_time).unix()}))}},mounted:function(){var t=this,e=(0,g.getLocalAccounts)();if(e){var n=(0,g.getLocalChains)(),a={};Object.keys(e).forEach((function(t){e[t].address.forEach((function(t){var e=n[t.chain];e&&(a[t.chain]=e)}))})),Object.values(a).forEach((function(e){t.fetchProposals(e)}))}},methods:{estmatetime:function(t,e){if(e.height>0){var n=this.latest[t];if(n){var a=e.height-this.latest[t].height;if(a>0)return T()().add(6*a,"second").format("YYYY-MM-DD hh:mm:ss")}return"1990-01-01"}return T()(e.time).format("YYYY-MM-DD hh:mm:ss")},fetchProposals:function(t){var e=this;this.$http.getGovernanceList("",t).then((function(n){n.proposals.forEach((function(n){var a=n.contents["@type"];if(a.indexOf("SoftwareUpgradeProposal")>0){var r=n;r.chain=t,T()(n.voting_end_time).add(15,"day").isAfter(T()())&&e.proposals.push(r)}}))}),(function(t){throw new Error(t)})),this.$http.getLatestBlock(t).then((function(n){e.$set(e.latest,t.chain_name,n.block.header)}))}}},A=O,B=n(1001),S=(0,B.Z)(A,x,k,!1,null,null,null),E=S.exports,j=n(49376),F={components:{BAvatar:o.SH,BTab:s.L,BTabs:i.M,BRow:l.T,BCol:c.l,BCard:u._,BCardFooter:d.F,BCardTitle:f._,BBadge:p.k,BProgress:v.D,BProgressBar:h.Q,BTooltip:m.T,WalletUpgradeEvents:E,ObjectFieldComponent:j.Z},directives:{"b-tooltip":b.o,Ripple:_.Z},data:function(){return{islive:!0,proposals:[],descId:null,tally:{},votes:[]}},computed:{list:function(){var t=this;return this.proposals.map((function(e){var n=e;return n.tally=t.tally["".concat(e.chain.chain_name,"-").concat(e.id)]||new g.ProposalTally,n.votes=t.votes.filter((function(t){return t.vote.proposal_id===e.id})),n})).sort((function(t,e){return T()(e.voting_start_time).unix()-T()(t.voting_start_time).unix()}))}},created:function(){this.init()},beforeDestroy:function(){this.islive=!1},methods:{description:function(t){this.descId=t===this.descId?null:t},color:function(t){switch(t){case"VOTE_OPTION_YES":return"success";case"VOTE_OPTION_NO":return"warning";case"VOTE_OPTION_NOWITHVETO":return"danger";case"VOTE_OPTION_ABSTAIN":return"info";default:return"danger"}},keyname:function(t){var e=Object.values(this.accounts).find((function(e){return e.address.findIndex((function(e){return e.addr===t}))>-1}));return e?e.name:t.substring(t.length-6)},formatType:function(t){var e=String(t).replace("Proposal",""),n=e.lastIndexOf(".");return n>0?e.substring(n+1):e},percent:function(t){return(0,g.percent)(t)},formatDate:function(t){return T()(t).format("YYYY-MM-DD")},formatToken:function(t){return(0,g.tokenFormatter)(t,{})},formatOption:function(t){var e=String(t).lastIndexOf("_");return e>0?String(t).substring(e+1):t},init:function(){var t=this;if(this.accounts=(0,g.getLocalAccounts)(),this.accounts){var e=(0,g.getLocalChains)(),n={};Object.keys(this.accounts).forEach((function(a){t.accounts[a].address.forEach((function(t){var a=e[t.chain];a&&(n[t.chain]?n[t.chain].addresses.push(t.addr):n[t.chain]={conf:a,addresses:[t.addr]})}))})),Object.values(n).forEach((function(e){t.fetchProposals(e)}))}},fetchProposals:function(t){var e=this;if(this.islive){var n=Promise.resolve();this.$http.getGovernanceListByStatus(2,t.conf).then((function(a){a.proposals.forEach((function(a){var r=a;r.chain=t.conf,e.proposals.push(r),t.addresses.forEach((function(r){n=n.then((function(){return new Promise((function(n){e.fetchMyVote(a.id,r,t.conf,n)}))}))}))})),e.updateTally(a.proposals,t.conf)}),(function(t){throw new Error(t)}))}},fetchMyVote:function(t,e,n,a){var r=this;this.islive&&this.$http.getGovernanceProposalVote(t,e,n).then((function(t){a();var e=t;e.keyname=r.keyname(t.vote.voter),r.votes.push(e)})).catch((function(){a()}))},updateTally:function(t,e){var n=this;t.length>0&&t.forEach((function(t){return n.$http.getGovernanceTally(t.id,0,e).then((function(a){n.$set(n.tally,"".concat(e.chain_name,"-").concat(t.id),a)}))}))}}},P=F,D=(0,B.Z)(P,a,r,!1,null,"0b4a9fbc",null),H=D.exports},9644:function(t,e,n){n.d(e,{Z:function(){return d}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return Array.isArray(t.items)?n("b-table",{staticClass:"ml-0 mr-0 dataview text-nowrap",attrs:{items:t.items,"sticky-header":!0,"no-border-collapse":!0,responsive:"md"},scopedSlots:t._u([{key:"cell()",fn:function(e){return[t.isTokenField(e.value)?n("span",[t._v(t._s(t.formatTokens(e.value)))]):t.isHex(e.value)?n("span",[t._v(t._s(t.formatHexAddress(e.value)))]):t.isArrayText(e.value)?n("array-field-component",{attrs:{tablefield:t.eval_value(e.value)}}):n("span",{attrs:{title:e.value}},[t._v(t._s(t.formatText(e.value)))])]}}],null,!1,3233310829)}):t._e()},r=[],o=(n(21249),n(23157),n(27852),n(74916),n(77601),n(67566)),s=n(54333),i={name:"ArrayFieldComponent",components:{BTable:o.h},props:{tablefield:{type:[Array,Object],default:function(){return[]}}},computed:{items:function(){return this.tablefield.length>0&&"string"===typeof this.tablefield[0]?this.tablefield.map((function(t){return{array:t}})):this.tablefield}},methods:{eval_value:function(t){return"string"===typeof t?JSON.parse(t):t},isTokenField:function(t){return(0,s.isToken)(t)},isArrayText:function(t){var e=String(t).startsWith("[")&&String(t).endsWith("]");return e},formatText:function(t){var e=/^\d{4}.\d{1,2}.\d{1,2}T\d{2}:\d{2}:.+Z$/,n=/^0\.\d+/;return e.test(t)?(0,s.toDay)(t):n.test(t)?"".concat((0,s.percent)(t),"%"):t},formatTokens:function(t){return(0,s.tokenFormatter)(t)},isHex:function(t){return(0,s.isHexAddress)(t)},formatHexAddress:function(t){return(0,s.getStakingValidatorByHex)(this.$http.config.chain_name,t)}}},l=i,c=n(1001),u=(0,c.Z)(l,a,r,!1,null,"3a881559",null),d=u.exports},49376:function(t,e,n){n.d(e,{Z:function(){return g}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return"object"===typeof t.tablefield?n("b-table-simple",{attrs:{hover:"",small:t.small,striped:"",stacked:"sm",responsive:"sm"}},[n("b-tbody",t._l(t.tablefield,(function(e,a){return n("b-tr",{key:a},[n("b-td",{staticStyle:{"text-transform":"capitalize","vertical-align":"top"}},[t._v(" "+t._s(t.formatTitle(a))+" ")]),t.isTokenField(e)?n("b-td",[t._v(" "+t._s(t.formatTokens(e))+" ")]):t.isArrayText(e)?n("b-td",[t._v(" "+t._s(e.join(", "))+" ")]):t.isHex(e)?n("b-td",[t._v(" "+t._s(t.formatHexAddress(e))+" ")]):Array.isArray(e)?n("b-td",[n("array-field-component",{attrs:{tablefield:e}})],1):"object"===typeof e?n("b-td",{staticClass:"overflow-hidden",attrs:{hover:""}},[e?n("b-tabs",{attrs:{small:""}},t._l(Object.keys(e),(function(a){return n("b-tab",{key:a,staticClass:"p-0",attrs:{title:t.formatTitle(a),"title-item-class":"bg-light-primary text-capitalize"}},[Array.isArray(e[a])?n("array-field-component",{attrs:{tablefield:e[a]}}):"object"===typeof e[a]?n("object-field-component",{attrs:{tablefield:e[a]}}):t.isObjectText(e[a])?n("object-field-component",{attrs:{tablefield:t.toObject(e[a])}}):n("div",{staticStyle:{"max-width":"800px","max-height":"300px",overflow:"auto"}},[t._v(t._s(e[a]))])],1)})),1):t._e()],1):n("b-td",["description"===a?n("VueMarkdown",[t._v(" "+t._s(t.addNewLine(e))+" ")]):n("div",{staticStyle:{"max-width":"800px","max-height":"300px",overflow:"auto"}},[t._v(t._s(e))])],1)],1)})),1)],1):t._e()},r=[],o=(n(74916),n(15306),n(68757),n(23157),n(27852),n(91038),n(78783),n(77601),n(85589)),s=n(92095),i=n(66456),l=n(58887),c=n(51015),u=n(80560),d=n(54333),f=n(89296),p=n.n(f),v=n(9644),h={name:"ObjectFieldComponent",components:{BTableSimple:o.t,BTr:s.G,BTd:i.S,BTabs:l.M,BTab:c.L,BTbody:u.p,ArrayFieldComponent:v.Z,VueMarkdown:p()},props:{tablefield:{type:[Array,Object],default:function(){}},small:{type:Boolean,default:!0}},data:function(){return{options:{markdownIt:{linkify:!0},linkAttributes:{attrs:{target:"_blank",rel:"noopener"}}}}},methods:{formatObject:function(t){return t},formatTitle:function(t){return String(t).replaceAll("_"," ")},isObjectText:function(t){return String(t).startsWith("{")&&String(t).endsWith("}")},toObject:function(t){return JSON.parse(t)},formatText:function(t){return(0,d.abbr)(t,60)},eval_value:function(t){return Array.from(t)},isTokenField:function(t){return!!t&&(0,d.isToken)(t)},isHex:function(t){return!!t&&(0,d.isHexAddress)(t)},formatHexAddress:function(t){return(0,d.getStakingValidatorByHex)(this.$http.config.chain_name,t)},isArrayText:function(t){return!!t&&(0,d.isStringArray)(t)},formatTokens:function(t){return(0,d.tokenFormatter)(t)},addNewLine:function(t){var e=/^0\.\d+/;return e.test(t)?"".concat((0,d.percent)(t),"%"):t?t.replace(/(?:\\[rn])+/g,"\n"):"-"}}},m=h,b=n(1001),_=(0,b.Z)(m,a,r,!1,null,"08f8a3cd",null),g=_.exports}}]);