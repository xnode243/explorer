"use strict";(self["webpackChunkping_wallet"]=self["webpackChunkping_wallet"]||[]).push([[7219],{67219:function(t,s,e){e.r(s),e.d(s,{default:function(){return w}});var i=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"container-md px-0"},[t.chainVals?e("b-row",t._l(Object.keys(t.chainVals),(function(s,i){return e("b-col",{key:i,staticClass:"text-truncate",attrs:{sm:"12",md:"4"}},[e("uptime-my-chain-blocks",{attrs:{chain:s,validators:t.chainVals[s]}})],1)})),1):t._e(),e("b-alert",{staticClass:"mt-2",attrs:{variant:"success",show:""}},[e("div",{staticClass:"alert-heading"},[t._v(" Tips ")]),e("div",{staticClass:"alert-body"},[t._v(" There are two ways to monitor your validators: "),e("li",[t._v(" Pin a validator on Uptime pages.")]),e("li",[t._v(" Specify parameters like following: "),e("pre",[t._v('https://ping.pub/cosmos/uptime/my?validators={"sifchain":["FBADE9A30473BB9ED6DFA16BFB3838E028F33650"],"chain_name":["hexAddress"]}')])])])])],1)},a=[],n=(e(41539),e(21249),e(74916),e(23123),e(54747),e(47941),e(69826),e(82526),e(41817),e(26253)),o=e(50725),r=e(73106),c=e(5870),l=e(54333),d=e(28972),h=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"px-0"},[e("b-card",[e("b-card-title",{staticClass:"d-flex justify-content-between"},[e("span",{staticClass:"text-uppercase"},[t._v(" "+t._s(t.chain)+" ")]),e("small",{staticClass:"text-right"},[t._v(" Height: "+t._s(t.height)+" ")])]),e("b-alert",{attrs:{variant:"danger",show:t.syncing}},[e("div",{staticClass:"alert-body"},[e("span",[t._v("No new blocks have been produced since "),e("strong",[t._v(t._s(t.latestTime))])])])]),e("b-row",[0===t.uptime.length?e("span",{staticClass:"text-danger"},[t._v(" Your node is out of active validator set")]):t._e(),t._l(t.uptime,(function(s,i){return e("b-col",{key:i,staticClass:"text-truncate",attrs:{sm:"12"}},[e("div",{staticClass:"d-flex justify-content-between"},[e("b-form-checkbox",{staticClass:"custom-control-warning",attrs:{value:t.chain+"#"+s.address},on:{change:function(e){return t.pinValidator(t.chain+"#"+s.address)}},model:{value:t.pinned,callback:function(s){t.pinned=s},expression:"pinned"}},[e("span",{staticClass:"d-inline-block text-truncate font-weight-bold align-bottom"},[t._v(" "+t._s(s.validator.moniker)+" ")])]),t.missing[s.address]?e("span",[t.missing[s.address].missed_blocks_counter>0?e("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.v-danger",modifiers:{hover:!0,"v-danger":!0}}],staticClass:"text-danger text-bolder",attrs:{variant:"light-danger",title:t.missing[s.address].missed_blocks_counter+" missed blocks"}},[t._v(" "+t._s(t.missing[s.address].missed_blocks_counter)+" ")]):e("b-badge",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.v-success",modifiers:{hover:!0,"v-success":!0}}],attrs:{variant:"light-success",title:"Perfect! No missed blocks"}},[t._v(" 0 ")])],1):t._e()],1),e("div",{staticClass:"d-flex justify-content-between align-self-stretch flex-wrap"},t._l(t.blocks,(function(i,a){return e("div",{key:a,staticStyle:{width:"1.5%"}},[e("router-link",{attrs:{to:"./blocks/"+i.height}},[e("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.v-second",modifiers:{hover:!0,"v-second":!0}}],staticClass:"m-auto",class:i.sigs&&i.sigs[s.address]?i.sigs[s.address]:"bg-light-success",attrs:{title:i.height}},[t._v("Â ")])])],1)})),0)])}))],2)],1)],1)},u=[],f=(e(91038),e(78783),e(82481),e(9653),e(26034)),v=e(8775),g=e(49379),m=e(65098),p={name:"Blocks",components:{BBadge:f.k,BRow:n.T,BCol:o.l,BCard:v._,BAlert:r.F,BCardTitle:g._,BFormCheckbox:m.l},directives:{"b-tooltip":c.o},props:{chain:{type:String,default:null},validators:{type:Array,default:function(){return[]}}},data:function(){var t=(0,l.getLocalChains)(),s=localStorage.getItem("pinned")?localStorage.getItem("pinned").split(","):"";return{pinned:s,config:t[this.chain],missing:{},blocks:Array.from("0".repeat(50)).map((function(t){return{sigs:{},height:Number(t)}})),syncing:!1,latestTime:"",height:"-"}},computed:{uptime:function(){var t=this.validators;return t}},created:function(){var t=this;this.initBlocks(),this.$http.getSlashingSigningInfo(this.config).then((function(s){s.info&&s.info.forEach((function(s){if(s.address){var e=(0,d.toBase64)((0,d.fromBech32)(s.address).data);t.missing[e]=s}}))}))},beforeDestroy:function(){this.blocks=[],this.syncing=!1,clearInterval(this.timer)},methods:{pinValidator:function(){localStorage.setItem("pinned",this.pinned)},initBlocks:function(){var t=this;this.$http.getLatestBlock(this.config).then((function(s){var e=s.block.last_commit.height;t.height=e,(0,l.timeIn)(s.block.header.time,3,"m")?t.syncing=!0:t.syncing=!1,t.latestTime=(0,l.toDay)(s.block.header.time,"long");for(var i=[],a=Promise.resolve(),n=function(s){i.unshift({sigs:{},height:s>0?s:0}),s>e-48&&s>0&&(a=a.then((function(){return new Promise((function(e){t.fetch_status(s,e)}))})))},o=e-1;o>e-50;o-=1)n(o);var r=t.initColor();s.block.last_commit.signatures.forEach((function(t){t.validator_address&&(r[t.validator_address]="bg-success")})),i.push({sigs:r,height:e}),t.blocks=i,t.timer=setInterval(t.fetch_latest,6e3)}))},initColor:function(){var t={};return this.validators.forEach((function(s){t[s.address]="bg-danger"})),t},fetch_status:function(t,s){var e=this,i=this.blocks.find((function(s){return s.height===t}));i&&this.$http.getBlockByHeight(t,this.config).then((function(t){s();var a=e.initColor();t.block.last_commit.signatures.forEach((function(t){t.validator_address&&(a[t.validator_address]="bg-success")})),e.$set(i,"sigs",a)}))},fetch_latest:function(){var t=this;this.$http.getLatestBlock(this.config).then((function(s){var e=t.initColor();s.block.last_commit.signatures.forEach((function(t){t.validator_address&&(e[t.validator_address]="bg-success")})),t.height=s.block.last_commit.height;var i=t.blocks.find((function(t){return t.height===s.block.last_commit.height}));"undefined"===typeof i&&(t.blocks.length>=50&&t.blocks.shift(),t.blocks.push({sigs:e,height:s.block.last_commit.height}))}))}}},b=p,_=e(1001),k=(0,_.Z)(b,h,u,!1,null,null,null),y=k.exports,C={components:{BRow:n.T,BCol:o.l,BAlert:r.F,UptimeMyChainBlocks:y},directives:{"b-tooltip":c.o},data:function(){var t=this,s=(localStorage.getItem("pinned")||"").split(",").map((function(t){return t.split("#")})).reduce((function(t,s){var e=t;return e[s[0]]?e[s[0]].push(s[1]):e[s[0]]=[s[1]],e}),{});this.$route.query.validators&&(s=JSON.parse(this.$route.query.validators));var e={};if(s){var i=(0,l.getLocalChains)();Object.keys(s).forEach((function(a){var n=JSON.parse((0,l.getCachedValidators)(a));if(n){var o=[];s[a].forEach((function(s){var e=n.find((function(e){return s===t.hex2base64((0,l.consensusPubkeyToHexAddress)(e.consensus_pubkey))}));e&&o.push({address:s,validator:e.description})})),e[a]=o}else t.$http.getValidatorList(i[a]).then((function(e){var i=[];s[a].forEach((function(s){var a=e.find((function(e){return s===t.hex2base64((0,l.consensusPubkeyToHexAddress)(e.consensus_pubkey))}));a&&i.push({address:s,validator:a.description})})),t.$set(t.chainVals,a,i)}))}))}return{chainVals:e}},methods:{hex2base64:function(t){return(0,d.toBase64)((0,d.fromHex)(t))}}},B=C,x=(0,_.Z)(B,i,a,!1,null,null,null),w=x.exports}}]);